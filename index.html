<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <title>reveal.js</title>

        <link rel="stylesheet" href="css/reveal.css">
        <link rel="stylesheet" href="css/theme/black.css">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

        <!-- Theme used for syntax highlighting of code -->
        <link rel="stylesheet" href="lib/css/zenburn.css">

        <!-- left-justification -->
        <style type="text/css">
        .reveal .slides { text-align: left; }
        </style>

        <!-- Printing and PDF exports -->
        <script>
            var link = document.createElement( 'link' );
            link.rel = 'stylesheet';
            link.type = 'text/css';
            link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
            document.getElementsByTagName( 'head' )[0].appendChild( link );
        </script>
    </head>
    <body>
        <div class="reveal">
            <div class="slides">
<!-- start of slide content -->
<section>
<img src="resources/conda_logo.svg" alt="Conda logo" />
<h3>yet another package manager</h3>
<a href="https://twitter.com/willfurnass"><i class="fa fa-twitter" aria-hidden="true"></i></a> /
<a href="https://github.com/willfurnass"><i class="fa fa-github" aria-hidden="true"></i></a> &nbsp;
@willfurnass
</section>

<section>
<h2>Outline</h2>
<ul>
    <li>Motivation</li>
    <li>TODO</li>
</ul>
</section>


<section>
<h2>Assumptions</h2>
<p> Assumption: you want to work on / use software that has both:</p>
<ul>
    <li> Python bits</li>
    <li> Non-Python bits</li>
</ul>

<p>e.g.</p>

<ul>
    <li class="fragment"> use a Py pkg that depends on <code>libxml</code>; </li>
    <li class="fragment"> use a Py pkg that depends on linear algebra C lib; </li>
    <li class="fragment"> Mu, the BBC micro:bit IDE: depends on some Qt libraries for the GUI and serial comms. </li>
</ul>
</section>

<section>
<h3>Requirements</h3>
<p>When working on a Py + non-Py project we want:</p>

<ul>
    <li class="fragment"> To be able to use Py and non-Py pkgs and pkg versions you want, regardless of OS pkgs; </li>
    <li class="fragment"> Separation / independence from system packages to ensure/test portability; </li>
    <li class="fragment"> To work as an unprivileged user. </li>
    <li class="fragment"> For us and other users not to be tied to a given OS/environment. </li>
</ul>
</section>

<section>
<h4> Install everything as root using OS package manager?</h4>
<ul class="fragment">
    <li> - Can only have one version of each pkg for all projects (no sandboxing)  </li>
    <li> - Limited to older versions of pkgs </li>
    <li> - Limited selection of pkgs </li>
    <li> - May not be easy/possible to switch to Py3 (e.g. on Centos 7) </li>
</ul>
</section>

<section>
<h4>Install Py stuff as root using pip?</h4>
<ul class="fragment">
    <li> + Newer Py pkgs </li>
</ul>
<ul class="fragment">
    <li> - Now using two pkg managers </li>
        <ul> 
            <li> - Conflicts! </li>
            <li> - May break your OS as many \*nix OS utilities written in Py </li>
            <li> - How to keep Py and non-Py deps in sync? </li>
        </ul>
    <li> - No sandboxing </li>
    <li> - Can only have one version of each package for all projects </li>
    <li> - Slow to install if no wheel available and may need a compiler (urgh) </li>
</ul>
</section>

<section>
<h4>Install Py pkgs in virtualenv?</h4>
<ul class="fragment">
    <li> + Newer Py pkgs  </li>
    <li> + Safer as no longer root  </li>
    <li> + Sandboxing of python pkgs - can have different vers per venv  </li>
</ul>
<ul class="fragment">
    <li> - Still using two pkg managers (OS for non-Py stuff) </li>
        <ul> 
            <li> + No conflicts and won't break your OS <em>but</em></li>
            <li> - How to keep Py and non-Py deps in sync? </li>
        </ul>
    <li> - Slow to install if no wheel available and may need a compiler (urgh) </li>
</ul>
</section>

<section>
<h4>Docker / Singularity?</h4>
<ul class="fragment">
    <li> + Py and non-py pkgs contained </li>
    <li> - Still using multiple packages internally if want latest Py pkgs </li>
    <li> - How to track / maintain what is compatible? </li>
</section>

<section>
<h3>Another approach: Conda</h3>

Yet another package manager (groan) <em>but</em>:

<ul>
    <li> A conda pkg can be pure Py (e.g. PyPI pkg with little extra md) </li>
    <li> <em>or</em> can be non-Py! </li>
    <li>Provides <em>environments</em> (like virtualenvs) </li>
        <ul>
            <li> Keep system and dev pkgs separate (even compiled libraries) </li>
            <li> Can do <em>everything</em> as unprivileged user </li>
            <li> Different pkgs and pkg versions per env </li>
        </ul>
</ul>
</section>
<section>
<ul>
    <li> Binary-only packages </li>
        <ul>
            <li> Built for Windows (32b, 64b), macOS, Linux (32b, 64b) and </li>
            <li> for maj+min Py vers (+ maybe key dependency vers) </li>
                <ul>
                    <li> e.g. Binary pkg for Linux 64bit + Py 3.6 + <code>numpy</code> 1.12 </li>
                </ul>
        </ul>
    <li> No reason not to use in Docker! </li>
</ul>
</section>

<section>
<h3>Let's play...</h3>

<ul>
    <li> Download <strong>Miniconda</strong> installer from <a href="https://repo.continuum.io/miniconda/">https://repo.continuum.io/miniconda/</a></li>
    <li> Run installer (using e.g. <code>sh miniconda-latest.sh</code> on macOS / Linux)</li>
    <li> Install into default location (e.g. <code>~/miniconda3</code>) </li>
    <li> Do not prepend the Miniconda install location to your <code>PATH</code> </li>
    <li> Windows: do not add Miniconda Python to registry </li>
</ul>
</section>


<section>
<h3> Make conda available</h3>

<ul>
    <li> <strong>Windows</strong>: Start a Miniconda shell from the <em>Start</em> menu. </li>
    <li> <strong>Linux / macOS</strong>: Ensure <code>conda</code> can be found on your <code>$PATH</code>:
<div class="org-src-container">
<pre><code class="bash">export PATH="$HOME/miniconda3/bin:$PATH"</code></pre>
</div>
    </li>
</ul>

Should then be able to run:

<div class="org-src-container">
<pre><code class="bash">[will@acai ~]$ conda --version
conda 4.3.13
</code></pre>
</div>
</section>

<section>
<h3>Where am I? What's going on?</h3>

You are now in the <em>root</em> conda environment, which has its own Python install:

<div class="org-src-container">
<pre><code class="bash">[will@acai ~]$ which python
/home/will/miniconda3_pyshef/bin/python
[will@acai ~]$ python --version
Python 3.6.0 :: Continuum Analytics, Inc.
</code></pre>
</div>
</section>

<section>
<p>Small number of pkgs installed in root env:</p>

<div class="org-src-container">
<pre><code class="bash">[will@acai ~]$ conda list
# packages in environment at /home/will/miniconda3:
#
cffi                      1.9.1                    py36_0  
conda                     4.3.11                   py36_0  
conda-env                 2.6.0                         0  
cryptography              1.7.1                    py36_0  
idna                      2.2                      py36_0  
libffi                    3.2.1                         1  
openssl                   1.0.2k                        0  
pip                       9.0.1                    py36_1  
pyasn1                    0.1.9                    py36_0  
pycosat                   0.6.1                    py36_1  
pycparser                 2.17                     py36_0  
pyopenssl                 16.2.0                   py36_0  
python                    3.6.0                         0  
readline                  6.2                           2  
requests                  2.12.4                   py36_0  
ruamel_yaml               0.11.14                  py36_1  
setuptools                27.2.0                   py36_0  
six                       1.10.0                   py36_0  
sqlite                    3.13.0                        0  
tk                        8.5.18                        0  
wheel                     0.29.0                   py36_0  
xz                        5.2.2                         1  
yaml                      0.1.6                         0  
zlib                      1.2.8                         3  
</code></pre>
</div>

<p>NB <code>requests</code> is Python, <code>zlib</code> is compiled shared library!</p>

</section>


<section>
<h2>Slide 2</h2>
<p>Some text</p>
<div class="org-src-container">
<pre><code class="c++">int i = 0;</code></pre>
</div>
<p>Some more text</p>
</section>

<section>Slide ?
<pre><code data-trim data-noescape>
(def lazy-fib
  (concat
   [0 1]
   <mark>((fn rfib [a b]</mark>
        (lazy-cons (+ a b) (rfib b (+ a b)))) 0 1)))
</code></pre>
</section>
<!-- end of slide content -->
            </div>
        </div>

        <script src="lib/js/head.min.js"></script>
        <script src="js/reveal.js"></script>

        <script>
            // More info https://github.com/hakimel/reveal.js#configuration
            Reveal.initialize({
                history: true,

                // More info https://github.com/hakimel/reveal.js#dependencies
                dependencies: [
                    { src: 'plugin/markdown/marked.js' },
                    { src: 'plugin/markdown/markdown.js' },
                    { src: 'plugin/notes/notes.js', async: true },
                    { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
                ]
            });
            // "c/t": flattened slide number / total slides
            Reveal.configure({ slideNumber: 'c/t' });
        </script>
    </body>
</html>
